"use strict";(self["webpackChunkresource"]=self["webpackChunkresource"]||[]).push([[821],{3494:function(e,s,t){t.r(s),t.d(s,{default:function(){return b}});var a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"messageAssets"},[e._m(0),s("div",{staticClass:"messageHeader"},[s("el-badge",{staticClass:"messageHeaderReported",attrs:{value:e.reportedMessage,max:99}},[s("el-button",{attrs:{type:"info"},on:{click:e.gotoMessageReported}},[e._v("损坏上报")])],1),s("el-badge",{staticClass:"messageHeaderAssets",attrs:{value:e.assetsMessage,max:99}},[s("el-button",{attrs:{type:"success"}},[e._v("资金审批")])],1)],1),s("div",{staticClass:"messageAssetsInner"},[s("el-table",{ref:"filterTable",staticClass:"assetsTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{align:"center",prop:"applyId",label:"申请id"}}),s("el-table-column",{attrs:{align:"center",prop:"applyNameId",label:"申请人id"}}),s("el-table-column",{attrs:{align:"center",prop:"applyName",label:"申请人名称"}}),s("el-table-column",{attrs:{align:"center",prop:"applyAssets",label:"申请金额",formatter:e.formatter}}),s("el-table-column",{attrs:{align:"center",prop:"applyState",label:"状态",filters:[{text:"未处理",value:"未处理"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:"info","disable-transitions":""}},[e._v(e._s(t.row.applyState))])]}}])}),s("el-table-column",{attrs:{align:"center",prop:"applyDescription",label:"申请信息描述"}}),s("el-table-column",{attrs:{align:"center",prop:"disposeTime",label:"申请时间",sortable:"",width:"160","column-key":"disposeTime"}}),s("el-table-column",{attrs:{label:"处理"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(s){return e.disposeButton(t.$index,t.row)}}},[e._v("处理")])]}}])})],1),s("el-dialog",{staticClass:"itemsDialog",attrs:{title:"申请资金处理",visible:e.dialogFormVisibleEdit,"append-to-body":!0},on:{"update:visible":function(s){e.dialogFormVisibleEdit=s}}},[s("el-form",{ref:"dispose",staticClass:"demo-ruleForm",attrs:{model:e.dispose,rules:e.rules}},[s("el-form-item",{attrs:{label:"申请id",prop:"applyId"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.applyId,callback:function(s){e.$set(e.dispose,"applyId",s)},expression:"dispose.applyId"}})],1),s("el-form-item",{attrs:{label:"申请人",prop:"applyName"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.applyName,callback:function(s){e.$set(e.dispose,"applyName",s)},expression:"dispose.applyName"}})],1),s("el-form-item",{attrs:{label:"申请描述",prop:"applyDescription"}},[s("el-input",{attrs:{type:"textarea",disabled:!0},model:{value:e.dispose.applyDescription,callback:function(s){e.$set(e.dispose,"applyDescription",s)},expression:"dispose.applyDescription"}})],1),s("el-form-item",{attrs:{label:"申请资金",prop:"applyAssets"}},[s("el-input",{model:{value:e.dispose.applyAssets,callback:function(s){e.$set(e.dispose,"applyAssets",e._n(s))},expression:"dispose.applyAssets"}})],1),s("el-form-item",{attrs:{label:"是否同意申请资金添加新物品",prop:"applyState"}},[s("el-radio-group",{model:{value:e.dispose.applyState,callback:function(s){e.$set(e.dispose,"applyState",s)},expression:"dispose.applyState"}},[s("el-radio",{attrs:{label:"同意"}}),s("el-radio",{attrs:{label:"不同意"}})],1)],1),s("el-form-item",{attrs:{label:"处理人描述",prop:"disposeDescription"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.dispose.disposeDescription,callback:function(s){e.$set(e.dispose,"disposeDescription",s)},expression:"dispose.disposeDescription"}})],1),s("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.submitForm()}}},[e._v("提 交")])],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(s){e.dialogFormVisibleEdit=!1}}},[e._v("关 闭")])],1)],1)],1),s("div",{staticClass:"pagination"},[s("Pagination",{attrs:{total:e.total,totalPages:e.totalPages},on:{currentChange:e.currentChange}})],1)])},i=[function(){var e=this,s=e._self._c;return s("div",{staticClass:"itemsText"},[s("p",{staticClass:"itemsTextP"},[e._v("管理员审批")])])}],o=(t(7658),t(4799)),l=t(4092),p=t(4458),r=(t(7814),t(9440)),d=t(5433),n=t(7484),c=t.n(n),m={name:"Message-MessageAssets",components:{Pagination:p.Z},data(){return{tableData:[],dispose:{applyName:"",applyDescription:"",applyId:"",disposeNameId:"",disposeName:"",applyState:"",disposeDescription:""},rules:{applyState:[{required:!0,message:"请选择处理状态",trigger:"change"}],disposeDescription:[{required:!0,message:"请填入处理描述",trigger:"blur"}]},total:0,totalPages:10,pageSize:7,pageNum:1,dialogFormVisibleEdit:!1,reportedMessage:"",assetsMessage:""}},methods:{async getUnprocessedAssets(e){let s=await(0,o.mQ)({pageNum:e});console.log("未处理资金申请数据-----",s),s.data&&(this.tableData=[...s.data.data.list],this.total=s.data.data.total,this.totalPages=s.data.data.pages,this.tableData.forEach((e=>{e.disposeTime=c()(e.disposeTime).format("YYYY-MM-DD HH:mm:ss")})))},async postUpdateProcessedAssets(e,s,t,a,i){let l=await(0,o.tH)({applyId:e,disposeName:s,disposeNameId:t,applyState:a,disposeDescription:i});console.log("审批资金申请结果-----",l),1===l.data?(this.$message({type:"success",message:"审批成功咯!"}),this.getUnprocessedAssets(1)):0===l.data&&(this.$message({type:"error",message:"没钱咯!"}),this.getUnprocessedAssets(1))},submitForm(){this.$refs.dispose.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.dispose.disposeNameId=Number(this.dispose.disposeNameId),console.log("处理提交按钮-----",this.dispose),this.postUpdateProcessedAssets(this.dispose.applyId,this.dispose.disposeName,this.dispose.disposeNameId,this.dispose.applyState,this.dispose.disposeDescription),this.dialogFormVisibleEdit=!1,setTimeout((()=>{this.getUnprocessedAssets(1)}),500)}))},disposeButton(e,s){console.log("处理操作-----",e,s),this.dialogFormVisibleEdit=!0,this.dialogFormVisibleTitle="物品损坏处理",this.dispose.applyNameId=s.applyNameId,this.dispose.applyName=s.applyName,this.dispose.applyAssets=s.applyAssets,this.dispose.applyDescription=s.applyDescription,this.dispose.applyId=s.applyId,this.dispose.applyState=s.applyState,this.dispose.disposeNameId=this.$store.state.login.id,this.dispose.disposeName=this.$store.state.login.name,this.dispose.disposeDescription=""},currentChange(e){console.log("更新页码-----",e),this.pageNum=e,this.getUnprocessedAssets(e)},formatter(e,s){return e.applyAssets},filterTag(e,s){return s.applyState===e},clearFilter(){this.$refs.filterTable.clearFilter()},gotoMessageReported:(0,l.Z)((function(){this.$router.push({name:"admin_message_reported"}).catch((e=>e))}),1500)},created(){this.getUnprocessedAssets(1)},mounted(){(0,r.Z)().then((e=>{console.log("resReported",e),this.reportedMessage=e.data.data})),(0,d.Z)().then((e=>{console.log("resAssets",e),this.assetsMessage=e.data.data}))}},u=m,g=t(1001),y=(0,g.Z)(u,a,i,!1,null,"960f6db8",null),b=y.exports},6481:function(e,s,t){t.d(s,{s:function(){return o}});var a=t(4974);const i="/admin/messageReminding",o=()=>a.Z.get(i+"/getMessageQuantity")},7814:function(e,s,t){var a=t(6481);async function i(e){let s=await(0,a.s)();console.log("消息查询操作-----",s);let t=s.data.code;t&&e.$notify.info({title:"消息",message:"您有待审批消息",offset:70})}s.Z=i}}]);
//# sourceMappingURL=821.b0923920.js.map