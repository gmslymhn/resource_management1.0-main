"use strict";(self["webpackChunkresource"]=self["webpackChunkresource"]||[]).push([[288],{1363:function(e,s,t){t.r(s),t.d(s,{default:function(){return h}});var a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"messageAssets"},[e._m(0),s("div",{staticClass:"messageHeader"},[s("el-badge",{staticClass:"messageHeaderReported",attrs:{value:e.reportedMessage,max:99}},[s("el-button",{attrs:{type:"info"},on:{click:e.gotoMessageReported}},[e._v("损坏上报")])],1),s("el-badge",{staticClass:"messageHeaderAssets",attrs:{value:e.assetsMessage,max:99}},[s("el-button",{attrs:{type:"success"}},[e._v("资金审批")])],1)],1),s("div",{staticClass:"messageAssetsInner"},[s("el-table",{ref:"filterTable",staticClass:"assetsTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{align:"center",prop:"applyId",label:"申请id"}}),s("el-table-column",{attrs:{align:"center",prop:"applyNameId",label:"申请人id"}}),s("el-table-column",{attrs:{align:"center",prop:"applyName",label:"申请人名称"}}),s("el-table-column",{attrs:{align:"center",prop:"applyAssets",label:"申请金额",formatter:e.formatter}}),s("el-table-column",{attrs:{align:"center",prop:"applyState",label:"状态",filters:[{text:"未处理",value:"未处理"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:"info","disable-transitions":""}},[e._v(e._s(t.row.applyState))])]}}])}),s("el-table-column",{attrs:{align:"center",prop:"applyDescription",label:"申请信息描述"}}),s("el-table-column",{attrs:{align:"center",prop:"applyTime",label:"申请时间",sortable:"",width:"160","column-key":"applyTime"}}),s("el-table-column",{attrs:{label:"处理"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(s){return e.disposeButton(t.$index,t.row)}}},[e._v("处理")])]}}])})],1),s("el-dialog",{staticClass:"itemsDialog",attrs:{title:"申请资金处理",visible:e.dialogFormVisibleEdit,"append-to-body":!0},on:{"update:visible":function(s){e.dialogFormVisibleEdit=s}}},[s("el-form",{ref:"dispose",staticClass:"demo-ruleForm",attrs:{model:e.dispose,rules:e.rules}},[s("el-form-item",{attrs:{label:"申请id",prop:"applyId"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.applyId,callback:function(s){e.$set(e.dispose,"applyId",s)},expression:"dispose.applyId"}})],1),s("el-form-item",{attrs:{label:"申请人",prop:"applyName"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.applyName,callback:function(s){e.$set(e.dispose,"applyName",s)},expression:"dispose.applyName"}})],1),s("el-form-item",{attrs:{label:"申请描述",prop:"applyDescription"}},[s("el-input",{attrs:{type:"textarea",disabled:!0},model:{value:e.dispose.applyDescription,callback:function(s){e.$set(e.dispose,"applyDescription",s)},expression:"dispose.applyDescription"}})],1),s("el-form-item",{attrs:{label:"申请资金",prop:"applyAssets"}},[s("el-input",{model:{value:e.dispose.applyAssets,callback:function(s){e.$set(e.dispose,"applyAssets",e._n(s))},expression:"dispose.applyAssets"}})],1),s("el-form-item",{attrs:{label:"是否同意申请资金添加新物品",prop:"applyState"}},[s("el-radio-group",{model:{value:e.dispose.applyState,callback:function(s){e.$set(e.dispose,"applyState",s)},expression:"dispose.applyState"}},[s("el-radio",{attrs:{label:"同意"}}),s("el-radio",{attrs:{label:"不同意"}})],1)],1),s("el-form-item",{attrs:{label:"处理人描述",prop:"disposeDescription"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.dispose.disposeDescription,callback:function(s){e.$set(e.dispose,"disposeDescription",s)},expression:"dispose.disposeDescription"}})],1),s("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.submitForm()}}},[e._v("提 交")])],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(s){e.dialogFormVisibleEdit=!1}}},[e._v("关 闭")])],1)],1)],1),s("div",{staticClass:"pagination"},[s("Pagination",{attrs:{total:e.total,totalPages:e.totalPages},on:{currentChange:e.currentChange}})],1)])},i=[function(){var e=this,s=e._self._c;return s("div",{staticClass:"itemsText"},[s("p",{staticClass:"itemsTextP"},[e._v("管理员审批")])])}],l=(t(7658),t(4799)),o=t(4092),p=t(4458),r=t(7814),d=t(9440),n=t(5433),c=t(7484),m=t.n(c),u={name:"Message-MessageAssets",components:{Pagination:p.Z},data(){return{tableData:[],dispose:{applyName:"",applyDescription:"",applyId:"",disposeNameId:"",disposeName:"",applyState:"",disposeDescription:""},rules:{applyState:[{required:!0,message:"请选择处理状态",trigger:"change"}],disposeDescription:[{required:!0,message:"请填入处理描述",trigger:"blur"}]},total:0,totalPages:10,pageSize:7,pageNum:1,dialogFormVisibleEdit:!1,reportedMessage:"",assetsMessage:""}},methods:{async getUnprocessedAssets(e){let s=await(0,l.mQ)({pageNum:e});console.log("未处理资金申请数据-----",s),s.data&&(this.tableData=[...s.data.data.list],this.total=s.data.data.total,this.totalPages=s.data.data.pages,this.tableData.forEach((e=>{e.applyTime=m()(e.applyTime).format("YYYY-MM-DD HH:mm:ss")})))},async postUpdateProcessedAssets(e,s,t,a,i){let o=(0,l.tH)({applyId:e,disposeName:s,disposeNameId:t,applyState:a,disposeDescription:i});console.log("审批损坏结果-----",o),200===o.state&&(this.$message({type:"success",message:"删除成功咯!"}),this.getUnprocessedAssets(1))},submitForm(){this.$refs.dispose.validate((e=>{if(!e)return console.log("error submit!!"),!1;this.dispose.disposeNameId=Number(this.dispose.disposeNameId),console.log("处理提交按钮-----",this.dispose),this.postUpdateProcessedAssets(this.dispose.applyId,this.dispose.disposeName,this.dispose.disposeNameId,this.dispose.applyState,this.dispose.disposeDescription),this.dialogFormVisibleEdit=!1}))},disposeButton(e,s){console.log("处理操作-----",e,s),this.dialogFormVisibleEdit=!0,this.dialogFormVisibleTitle="物品损坏处理",this.dispose.applyNameId=s.applyNameId,this.dispose.applyName=s.applyName,this.dispose.applyAssets=s.applyAssets,this.dispose.applyDescription=s.applyDescription,this.dispose.applyId=s.applyId,this.dispose.applyState=s.applyState,this.dispose.disposeNameId=this.$store.state.login.id,this.dispose.disposeName=this.$store.state.login.name},currentChange(e){console.log("更新页码-----",e),this.pageNum=e,this.getUnprocessedAssets(e,this.pageSize)},formatter(e,s){return e.applyAssets},filterTag(e,s){return s.applyState===e},clearFilter(){this.$refs.filterTable.clearFilter()},gotoMessageReported:(0,o.Z)((function(){this.$router.push({name:"admin_message_reported"}).catch((e=>e))}),1500)},created(){this.getUnprocessedAssets(this.pageNum)},mounted(){(0,r.Z)(this),(0,d.Z)().then((e=>{console.log("resReported",e),this.reportedMessage=e.data.data})),(0,n.Z)().then((e=>{console.log("resAssets",e),this.assetsMessage=e.data.data}))}},g=u,b=t(1001),y=(0,b.Z)(g,a,i,!1,null,"c1b7b936",null),h=y.exports}}]);
//# sourceMappingURL=288.b3c6ea33.js.map