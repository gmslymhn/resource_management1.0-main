"use strict";(self["webpackChunkresource"]=self["webpackChunkresource"]||[]).push([[473],{8693:function(e,s,t){t.r(s),t.d(s,{default:function(){return N}});var o=function(){var e=this,s=e._self._c;return s("div",{staticClass:"messageReported"},[e._m(0),s("div",{staticClass:"messageHeader"},[s("el-badge",{staticClass:"messageHeaderReported",attrs:{value:e.reportedMessage,max:99}},[s("el-button",{attrs:{type:"success"}},[e._v("损坏上报")])],1),s("el-badge",{staticClass:"messageHeaderAssets",attrs:{value:e.assetsMessage,max:99}},[s("el-button",{attrs:{type:"info"},on:{click:e.gotoMessageAssets}},[e._v("资金审批")])],1)],1),s("div",{staticClass:"messageReportedInner"},[s("el-table",{ref:"filterTable",staticClass:"reportedTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{align:"center",prop:"sequenceId",label:"上报信息id"}}),s("el-table-column",{attrs:{align:"center",prop:"reportNameId",label:"上报人id"}}),s("el-table-column",{attrs:{align:"center",prop:"reportName",label:"上报人"}}),s("el-table-column",{attrs:{align:"center",prop:"goodsId",label:"物品id"}}),s("el-table-column",{attrs:{align:"center",prop:"goodsName",label:"物品名称",formatter:e.formatter}}),s("el-table-column",{attrs:{align:"center",prop:"goodsState",label:"状态",filters:[{text:"未处理",value:"未处理"}],"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:"info","disable-transitions":""}},[e._v(e._s(t.row.goodsState))])]}}])}),s("el-table-column",{attrs:{align:"center",prop:"damageDescription",label:"损坏描述"}}),s("el-table-column",{attrs:{align:"center",prop:"reportTime",label:"上报时间",sortable:"",width:"160","column-key":"reportTime"}}),s("el-table-column",{attrs:{label:"处理"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(s){return e.disposeButton(t.$index,t.row)}}},[e._v("处理")])]}}])})],1),s("el-dialog",{staticClass:"itemsDialog",attrs:{title:"损坏物品处理",visible:e.dialogFormVisibleEdit,"append-to-body":!0},on:{"update:visible":function(s){e.dialogFormVisibleEdit=s}}},[s("el-form",{ref:"dispose",staticClass:"demo-ruleForm",attrs:{model:e.dispose,rules:e.rules}},[s("el-form-item",{attrs:{label:"上报人",prop:"reportName"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.reportName,callback:function(s){e.$set(e.dispose,"reportName",s)},expression:"dispose.reportName"}})],1),s("el-form-item",{attrs:{label:"物品id",prop:"goodsId"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.goodsId,callback:function(s){e.$set(e.dispose,"goodsId",s)},expression:"dispose.goodsId"}})],1),s("el-form-item",{attrs:{label:"物品名字",prop:"goodsName"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.dispose.goodsName,callback:function(s){e.$set(e.dispose,"goodsName",s)},expression:"dispose.goodsName"}})],1),s("el-form-item",{attrs:{label:"上报人描述",prop:"damageDescription"}},[s("el-input",{attrs:{type:"textarea",disabled:!0},model:{value:e.dispose.damageDescription,callback:function(s){e.$set(e.dispose,"damageDescription",s)},expression:"dispose.damageDescription"}})],1),s("el-form-item",{attrs:{label:"是否删除已损坏物品",prop:"goodsState"}},[s("el-radio-group",{model:{value:e.dispose.goodsState,callback:function(s){e.$set(e.dispose,"goodsState",s)},expression:"dispose.goodsState"}},[s("el-radio",{attrs:{label:"是"}}),s("el-radio",{attrs:{label:"否"}})],1)],1),s("el-form-item",{attrs:{label:"是否申请资金购买新物品",prop:"gotoApply"}},[s("el-radio-group",{model:{value:e.dispose.gotoApply,callback:function(s){e.$set(e.dispose,"gotoApply",s)},expression:"dispose.gotoApply"}},[s("el-radio",{attrs:{label:"是"}}),s("el-radio",{attrs:{label:"否"}})],1)],1),s("el-form-item",{attrs:{label:"处理人描述",prop:"disposeDescription"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.dispose.disposeDescription,callback:function(s){e.$set(e.dispose,"disposeDescription",s)},expression:"dispose.disposeDescription"}})],1),s("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.submitForm()}}},[e._v("提 交")])],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(s){e.dialogFormVisibleEdit=!1}}},[e._v("关 闭")])],1)],1)],1),s("div",{staticClass:"pagination"},[s("Pagination",{attrs:{total:e.total,totalPages:e.totalPages},on:{currentChange:e.currentChange}})],1)])},a=[function(){var e=this,s=e._self._c;return s("div",{staticClass:"itemsText"},[s("p",{staticClass:"itemsTextP"},[e._v("管理员审批")])])}],i=(t(7658),t(7915)),r=t(6854),l=t(4092),d=t(4458),p=t(7814),n=t(9440),m=t(5433),g=t(7484),c=t.n(g),u={name:"Message-MessageReported",components:{Pagination:d.Z},data(){return{tableData:[],dispose:{reportName:"",goodsId:"",goodsName:"",damageDescription:"",gotoApply:"",sequenceId:"",disposeNameId:"",disposeName:"",disposeDescription:"",disposeResult:""},rules:{goodsState:[{required:!0,message:"请选择处理状态",trigger:"change"}],gotoApply:[{required:!0,message:"请选择是否跳转到申请资金",trigger:"change"}],disposeDescription:[{required:!0,message:"请填入处理描述",trigger:"blur"}]},total:100,totalPages:10,pageSize:7,pageNum:1,dialogFormVisibleEdit:!1,role:"",reportedMessage:"",assetsMessage:""}},methods:{async getUnprocessedReport(e){let s=await(0,i.n0)({pageNum:e});console.log("未处理损坏物品数据-----",s),s.data&&(this.tableData=[...s.data.data.list],this.total=s.data.data.total,this.totalPages=s.data.data.pages,this.tableData.forEach((e=>{e.applyTime=c()(e.applyTime).format("YYYY-MM-DD HH:mm:ss")})))},async postUpdateProcessedReport(e,s,t,o){let a=await(0,i.PN)({sequenceId:e,disposeNameId:s,disposeName:t,disposeDescription:o});console.log("审批损坏结果-----",a),200===a.state&&(this.$message({type:"success",message:"删除成功咯!"}),this.getUnprocessedReport(1))},submitForm(){this.$refs.dispose.validate((e=>{if(!e)return console.log("error submit!!"),!1;console.log("处理提交按钮-----",this.dispose),this.dispose.disposeNameId=Number(this.dispose.disposeNameId),this.postUpdateProcessedReport(this.dispose.sequenceId,this.dispose.disposeNameId,this.dispose.disposeName,this.dispose.disposeDescription),this.dialogFormVisibleEdit=!1,"是"===this.dispose.goodsState&&(console.log("调用物品损坏上报删除接口-----"),(0,r.nq)({sequenceId:this.dispose.sequenceId}).then((e=>{console.log("物品损坏上报删除此条目成功")}))),"是"===this.dispose.gotoApplyRes&&("user"===this.role?this.$router.push({name:"user_shenqing"}):"admin"===this.role&&this.$router.push({name:"admin_shenqing"}))}))},disposeButton(e,s){console.log("处理操作-----",e,s),this.dialogFormVisibleEdit=!0,this.dialogFormVisibleTitle="物品损坏处理",this.dispose.reportName=s.reportName,this.dispose.goodsId=s.goodsId,this.dispose.goodsName=s.goodsName,this.dispose.damageDescription=s.damageDescription,this.dispose.sequenceId=s.sequenceId,this.dispose.disposeNameId=this.$store.state.login.id,this.dispose.disposeName=this.$store.state.login.name},currentChange(e){console.log("更新页码-----",e),this.pageNum=e,this.getUnprocessedReport(e)},formatter(e,s){return e.goodsName},gotoMessageAssets:(0,l.Z)((function(){this.$router.push({name:"admin_message_assets"}).catch((e=>e))}),1500)},created(){this.getUnprocessedReport(this.pageNum),(0,p.Z)(this)},mounted(){(0,n.Z)().then((e=>{console.log("resReported",e),this.reportedMessage=e.data.data})),(0,m.Z)().then((e=>{console.log("resAssets",e),this.assetsMessage=e.data.data})),this.role=this.$store.state.login.role}},b=u,h=t(1001),f=(0,h.Z)(b,o,a,!1,null,"4346ec44",null),N=f.exports},6854:function(e,s,t){t.d(s,{Hv:function(){return r},K$:function(){return d},nq:function(){return p},uQ:function(){return l},up:function(){return i}});var o=t(4974);t(129);const a="/admin/admReport",i=({pageNum:e,pageSize:s})=>o.Z.get(a+"/getALLReport",{params:{pageNum:e,pageSize:s}}),r=({pageNum:e,pageSize:s,reportName:t})=>o.Z.get(a+"/selectByReportName",{params:{pageNum:e,pageSize:s,reportName:t}}),l=({pageNum:e,pageSize:s,disposeName:t})=>o.Z.get(a+"/selectByDisposeName",{params:{pageNum:e,pageSize:s,disposeName:t}}),d=({items:e})=>o.Z.get(a+"/addReport",{params:{reportNameId:e.reportNameId,reportName:e.reportName,goodsId:e.goodsId,damageDescription:e.damageDescription}}),p=({sequenceId:e})=>o.Z.get(a+"/deleteReport",{params:{sequenceId:e}})}}]);
//# sourceMappingURL=473.da0bdd9b.js.map